# 索引 #
索引是对表中一列或多列进行排序的结构，建立索引是加快查询速度的有效手段。系统自动建立主键和唯一列（unique）上的索引。索引可以理解为给正文（数据）加目录（索引），是不会把书中的页码打乱的。索引的数据存在于与表名相同的.cdx的文件中。

### 聚集索引 ###
聚集索引，叶子结点包含了完整的数据记录，即存储了真实的数据行。一张表只允许存在一个聚集索引。

Innodb 表的数据 必须要有一个B+树的聚集索引去组织，如果不创建主键，mysql会自己选一个字段（数据都是不重复的字段）作为主键，如果没有这样的字段，mysql会创建隐藏列，可能是整型的，来维护这些数据

## 为什么建立索引可以加快查询速度 ##
DB在执行一条查询语句的时候，默认的方式是根据搜索条件进行全表扫描，遇到匹配条件的就加入搜索结果集合。如果我们对某一字段增加索引，查询时就会先去索引列表中一次定位到特定值的行数，大大减少遍历匹配的行数，所以能明显加快查询的速度。

## 索引的基本操作
1. 建立索引

	UNIQUE表明此索引的每一个索引值只对应唯一的数据记录。
    	
		CREATE UNIQUE INDEX SCNO ON SC(Sno ASC,Cno DESC)(可排序)
	
		CREATE UNIQUE INDEX Stuname ON STUDENT(SNAME)

	CLUSTER表示要建立的索引是聚簇索引。
	
		CREATE CLUSTER INDEX Stusname ON Student(Sname)

2. 删除索引'Stuname'
	
DB2/ORACLE:

	DROP INDEX Stuname

MySql:

	ALTER TABLE TABLENAME DROP INDEX Stuname

SQL SERVER:

	DROP INDEX TABLENAME.Stuname

MS Access:

	DROP INDEX Stuname ON TABLENAME


B+树索引动态平衡，Hash索引查找速度快，但是不支持范围查询，所以适用的场景比较少。

## 建立索引的原则 ##

1. 表的某个字段值得离散度越高，该字段越适合选作索引的关键字。主键字段以及唯一性约束字段适合选作索引的关键字，原因就是这些字段的值非常离散。数据库用户创建主键约束的同时，MySQL 自动创建主索引（ primary index ），且索引名称为 Primary ；数据库用户创建唯一性索引时， MySQL 自动创建唯一性索引（unique index），默认情况下，索引名为唯一性索引的字段名。
2. 占用存储空间少的字段更适合选作索引的关键字。例如，与字符串相比，整数字段占用的存储空间较少，因此，较为适合选作索引关键字。
3. 存储空间固定的字段更适合选作索引的关键字。与 text 类型的字段相比，char 类型的字段较为适合选作索引关键字。
4. Where 子句中经常使用的字段应该创建索引，分组字段或者排序字段应该创建索引，两个表的连接字段应该创建索引。
5. 更新频繁的字段不适合创建索引，不会出现在 where 子句中的字段不应该创建索引。在查询中很少使用的列，有无索引并不能提高查询的速度，相反增加了系统维护时间和消耗了系统空间。
6. 有主键的数据列要建立索引。因为主键可以加速定位到表中的某一行。
7. 有外键的数据列要建立索引。外键列通常用于表与表之间的连接，在其上创建索引可以加快表间的连接。
8. 对于经常查询的数据列最好建立索引。
9. 对于定义为text、image和bit数据类型的列不要建立索引。因为这些数据类型的数据列的数据量要么很大、要么很小，不利于使用索引。

## 索引的缺点 ##
- 创建索引和维护索引要耗费时间，这种时间随着数据量的增加而增加。 
- 索引需要占物理空间，除了数据表占数据空间之外，每一个索引还要占一定的物理空间，如果 要建立聚簇索引，那么需要的空间就会更大。
- 当对表中的数据进行增加、删除和修改的时候，索引也要动态的维护，这样就降低了数据的维护速度。

## 任何时候都应该加索引吗？ ##
答案肯定是否定的，这里举几个反例：

1. 如果每次都需要取到所有的表记录，无论如何都必须进行全表扫描了，那么是否加索引也没有意义了。
2. 对非唯一的字段，例如“性别”这种大量重复值的字段，增加索引也没有意义。
3. 对于记录比较少的表，增加索引不会带来速度的优化反而浪费了存储空间，因为索引是需要存储空间的，而且有个致命缺点是对于update/insert/delete的每次执行，字段的索引都必须重新计算更新，这就拖慢了速度。

## 索引详解 ##
[http://blog.csdn.net/zdplife/article/details/48033919](http://blog.csdn.net/zdplife/article/details/48033919)
