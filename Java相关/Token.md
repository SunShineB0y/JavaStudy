## Token

Token是服务端生成的一串字符串，以作客户端进行请求的一个令牌。当客户端第一次访问服务端，服务端会根据传过来的唯一标识userId，运用一些算法，并加上密钥，生成一个Token，然后将这个Token返回给客户端，客户端将Token保存起来（可以通过数据库或文件形式保存本地）。下次请求时，客户端只需要带上Token，服务器收到请求后，会用相同的算法和密钥去验证Token。

### 使用Token验证身份的基本流程

- 客户端通过用户名和密码请求登录
- 服务器收到请求，并验证用户名和密码
- 验证成功后，服务器签发一个Token，并发送给客户端
- 客户端收到Token并存储，可以存到cookie里
- 客户端再次向服务器发起请求的时候会带上这个Token
- 服务器接收到请求并验证Token,验证通过则返回请求的数据

### 如何防止二次提交或防止Token被劫持

Token在服务器上会存储在session中，我们可以设置每次接受用户请求的时候，生成最新的Token，并随着响应一起返回，这样客户端的Token会跟着实时更新。

当Token被恶意篡改时，req中的Token与服务器的Token不一致，这样便不会通过验证。同样，二次提交的时候，客户端的Token已经不是最新的了，这样也不会通过验证。